import re

def normalize_text(text: str) -> str:
    """テキストを正規化（スペース除去、小文字化）"""
    text = text.replace(" ", "").replace("　", "")
    return text.lower()

def has_any(text: str, keywords: list) -> bool:
    """キーワードのいずれかが含まれるか"""
    return any(k in text for k in keywords)

def normalize_synonyms(text: str) -> str:
    """類義語を統一形に正規化"""
    synonyms = {
        # autoping関連
        "オートピング": "autoping", "おーとぴんぐ": "autoping", "自動ピング": "autoping",
        "自動ping": "autoping", "オートping": "autoping", "自動通知": "autoping",
        # DM関連
        "ダイレクトメッセージ": "dm", "ディーエム": "dm", "プライベートメッセージ": "dm",
        # 出禁関連
        "ブロック": "出禁", "ban": "出禁", "バン": "出禁", "追放": "出禁", "キック": "出禁",
        "締め出し": "出禁", "入室禁止": "出禁", "参加禁止": "出禁",
        # 管理者関連
        "admin": "管理者", "アドミン": "管理者", "モデレーター": "管理者", "mod": "管理者",
        # 追加関連
        "入れて": "追加", "登録": "追加", "加えて": "追加", "つけて": "追加", "付けて": "追加",
        "いれて": "追加", "加入": "追加", "参加": "追加",
        # 削除関連
        "外して": "削除", "消して": "削除", "除外": "削除", "取り消し": "削除", "はずして": "削除",
        "抜いて": "削除", "除いて": "削除", "取って": "削除", "とって": "削除",
        # 解除関連
        "外す": "解除", "やめて": "解除", "取り消して": "解除", "取消": "解除", "キャンセル": "解除",
        # オン関連
        "有効": "オン", "つけて": "オン", "入れて": "オン", "開始": "オン", "スタート": "オン",
        "起動": "オン", "enable": "オン", "on": "オン",
        # オフ関連
        "無効": "オフ", "止めて": "オフ", "停止": "オフ", "ストップ": "オフ", "終了": "オフ",
        "disable": "オフ", "off": "オフ",
        # 設定関連
        "セット": "設定", "変更": "設定", "指定": "設定", "切り替え": "設定",
        # チャット関連
        "メッセージ": "チャット", "発言": "チャット", "ログ": "チャット", "履歴": "チャット",
        "会話": "チャット", "投稿": "チャット",
        # 監視関連
        "ウォッチ": "監視", "watch": "監視", "対象": "監視", "見張り": "監視", "チェック対象": "監視",
        # VC関連
        "ボイスチャンネル": "vc", "ボイチャ": "vc", "通話": "vc", "ボイス": "vc", "音声チャンネル": "vc",
    }
    result = text.lower()
    for old, new in synonyms.items():
        result = result.replace(old.lower(), new.lower())
    return result
